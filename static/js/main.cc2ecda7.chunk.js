(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{21:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),o=n(9),r=(n(19),n(20),n(21),n(10)),s=n(2),i="https://mate.academy/students-api";function l(e){return new Promise((function(t){setTimeout(t,e)}))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:t};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),l(300).then((function(){return fetch(i+e,c)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var u=function(e){return d(e)},j=function(e,t){return d(e,"POST",t)},b=function(e,t){return d(e,"PATCH",t)},m=function(e){return d(e,"DELETE")},f=function(e){return m("/todos/".concat(e))},p=n(3),O=n(5),h=n(4),v=n.n(h),x=function(){var e=Object(O.a)(Object(p.a)().mark((function e(t){var n;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(O.a)(Object(p.a)().mark((function e(t){var n,c;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.name,e.abrupt("return",j("/users",{email:n,name:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=n(0),N=function(e){var t=e.onLogin,n=Object(c.useState)(""),a=Object(s.a)(n,2),o=a[0],r=a[1],i=Object(c.useState)(""),l=Object(s.a)(i,2),d=l[0],u=l[1],j=Object(c.useState)(!1),b=Object(s.a)(j,2),m=b[0],f=b[1],h=Object(c.useState)(!1),N=Object(s.a)(h,2),T=N[0],k=N[1],_=Object(c.useState)(""),S=Object(s.a)(_,2),C=S[0],w=S[1],L=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(c.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(c){}}),[]);var E=function(){var e=Object(O.a)(Object(p.a)().mark((function e(){var t;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(o);case 2:(t=e.sent)?L(t):f(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(O.a)(Object(p.a)().mark((function e(t){return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),w(""),k(!0),e.prev=3,!m){e.next=9;break}return e.next=7,y({name:d,email:o}).then(L);case 7:e.next=11;break;case 9:return e.next=11,E();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),w("Something went wrtong");case 16:return e.prev=16,k(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)("form",{onSubmit:I,className:"box mt-5",children:[Object(g.jsx)("h1",{className:"title is-3",children:m?"You need to register":"Log in to open todos"}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsxs)("label",{className:"label",htmlFor:"user-email",children:["Email",Object(g.jsxs)("div",{className:v()("control has-icons-left",{"is-loading":T}),children:[Object(g.jsx)("input",{type:"email",id:"user-email",className:v()("input",{"is-danger":!m&&C}),placeholder:"Enter your email",disabled:T||m,value:o,required:!0,onChange:function(e){return r(e.target.value)}}),Object(g.jsx)("span",{className:"icon is-small is-left",children:Object(g.jsx)("i",{className:"fas fa-envelope"})})]})]}),!m&&C&&Object(g.jsx)("p",{className:"help is-danger",children:C})]}),m&&Object(g.jsxs)("div",{className:"field",children:[Object(g.jsxs)("label",{className:"label",htmlFor:"user-name",children:["Your Name",Object(g.jsxs)("div",{className:v()("control has-icons-left",{"is-loading":T}),children:[Object(g.jsx)("input",{type:"text",id:"user-name",className:v()("input",{"is-danger":m&&C}),placeholder:"Enter your name",required:!0,minLength:4,disabled:T,value:d,onChange:function(e){return u(e.target.value)}}),Object(g.jsx)("span",{className:"icon is-small is-left",children:Object(g.jsx)("i",{className:"fas fa-user"})})]})]}),m&&C&&Object(g.jsx)("p",{className:"help is-danger",children:C})]}),Object(g.jsx)("div",{className:"field",children:Object(g.jsx)("button",{type:"submit",className:v()("button is-primary",{"is-loading":T}),children:m?"Register":"Login"})})]})},T=a.a.createContext(null),k=function(e){var t=e.children,n=Object(c.useState)(null),a=Object(s.a)(n,2),o=a[0],r=a[1];return o?Object(g.jsx)(T.Provider,{value:o,children:t}):Object(g.jsx)(N,{onLogin:r})},_=a.a.memo((function(e){var t=e.title;return Object(g.jsxs)("div",{"data-cy":"Todo",className:"todo",children:[Object(g.jsx)("label",{className:"todo__status-label",htmlFor:"todoStatus",children:Object(g.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",defaultChecked:!0,id:"todoStatus"})}),Object(g.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",children:t}),Object(g.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",children:"\xd7"}),Object(g.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay is-active",children:[Object(g.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(g.jsx)("div",{className:"loader"})]})]})})),S=a.a.memo((function(e){var t=e.todo,n=e.removeTodo,a=e.selectedTodoId,o=e.isRemoveLoading,r=e.updateTodoById,i=e.isUpdateLoading,l=e.isAllToggled,d=Object(c.useState)(!1),u=Object(s.a)(d,2),j=u[0],b=u[1],m=Object(c.useState)(t.title),f=Object(s.a)(m,2),p=f[0],O=f[1],h=Object(c.useRef)(null),x=o&&a===t.id||i&&a===t.id||l;Object(c.useEffect)((function(){h.current&&h.current.focus()}),[j]);var y=function(){return b(!1)},N=function(e){p?(r(e,{title:p}),b(!1)):n(t.id)};return Object(g.jsxs)("div",{"data-cy":"Todo",className:v()("todo",{completed:t.completed}),children:[Object(g.jsx)("label",{className:"todo__status-label",children:Object(g.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:t.completed,onChange:function(){r(t.id,{completed:!t.completed})}})}),j?Object(g.jsx)("form",{children:Object(g.jsx)("input",{"data-cy":"TodoTitleField",type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",defaultValue:p,ref:h,onBlur:function(){N(t.id),y()},onChange:function(e){return O(e.target.value)},onKeyDown:function(e){return n=e,c=t.id,"Escape"===n.key&&(y(),O(t.title)),void("Enter"===n.key&&(N(c),y()));var n,c}})}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){return b(!0)},children:t.title}),Object(g.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){n(t.id)},children:"\xd7"})]}),x&&Object(g.jsxs)("div",{"data-cy":"TodoLoader",className:v()("modal overlay",{"is-active":o||i}),children:[Object(g.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(g.jsx)("div",{className:"loader"})]})]})})),C=a.a.memo((function(e){var t=e.todos,n=e.removeTodo,c=e.selectedTodoId,a=e.isLoading,o=e.title,r=e.isRemoveLoading,s=e.updateTodoById,i=e.isUpdateLoading,l=e.isAllToggled;return Object(g.jsxs)("section",{className:"todoapp__main","data-cy":"TodoList",children:[t.map((function(e){return Object(g.jsx)(S,{todo:e,removeTodo:n,selectedTodoId:c,isRemoveLoading:r,updateTodoById:s,isUpdateLoading:i,isAllToggled:l},e.id)})),a&&Object(g.jsx)(_,{title:o})]})})),w=(n(23),function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)(""),i=Object(s.a)(o,2),l=i[0],d=i[1],m=Object(c.useState)(0),p=Object(s.a)(m,2),O=p[0],h=p[1],v=Object(c.useState)(null),x=Object(s.a)(v,2),y=x[0],N=x[1],k=Object(c.useState)(!1),_=Object(s.a)(k,2),S=_[0],w=_[1],L=Object(c.useState)(!1),E=Object(s.a)(L,2),I=E[0],F=E[1],B=Object(c.useState)(""),A=Object(s.a)(B,2),U=A[0],D=A[1],R=Object(c.useState)(!1),J=Object(s.a)(R,2),P=J[0],q=J[1],H=Object(c.useState)("all"),Y=Object(s.a)(H,2),G=Y[0],K=Y[1],M=Object(c.useState)(!1),V=Object(s.a)(M,2),W=V[0],z=V[1],Q=Object(c.useState)(!1),X=Object(s.a)(Q,2),Z=X[0],$=X[1],ee=Object(c.useContext)(T),te=function(e){D(e),setTimeout((function(){return D("")}),3e3)};Object(c.useEffect)((function(){ee&&(h(ee.id),function(e){return u("/todos?userId=".concat(e))}(ee.id).then((function(e){a(e)})).finally((function(){z(!1)})))}),[ee,W,Z]);var ne=Object(c.useCallback)((function(e){e.preventDefault(),l.trim()?(w(!0),ee&&function(e,t,n){return j("/todos",{title:e,userId:t,completed:n})}(l,O,!1).then((function(e){return a((function(t){return[].concat(Object(r.a)(t),[e])}))})).catch((function(){return te("Unable to add a todo")})).finally((function(){d(""),$(!1),w(!1)}))):te("Title can't be empty")}),[l,ee]),ce=Object(c.useCallback)((function(e,t){N(e),q(!0),function(e,t){return b("/todos/".concat(e),t)}(e,t).then((function(){z(!0)})).catch((function(){return te("Unable to update a todo")})).finally((function(){q(!1),$(!1)}))}),[]),ae=Object(c.useCallback)((function(){var e=n.every((function(e){return!0===e.completed}));$(!0),n.forEach((function(t){return ce(t.id,{completed:!e})}))}),[n]),oe=Object(c.useCallback)((function(e){N(e),F(!0),f(e).then((function(e){e&&z(!0)})).catch((function(){return te("Unable to delete a todo")})).finally((function(){return F(!1)}))}),[]),re=Object(c.useMemo)((function(){return n.filter((function(e){return"completed"===G?!0===e.completed:"active"===G?!1===e.completed:e}))}),[G,n]),se=Object(c.useCallback)((function(){n.filter((function(e){return e.completed})).map((function(e){return f(e.id)})),z(!0)}),[n]);return Object(g.jsxs)("div",{className:"todoapp",children:[Object(g.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(g.jsxs)("div",{className:"todoapp__content",children:[Object(g.jsxs)("header",{className:"todoapp__header",children:[re.length>0&&Object(g.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:"todoapp__toggle-all ".concat(n.every((function(e){return e.completed}))?"active":""),onClick:function(){return ae()}}),Object(g.jsx)("form",{onSubmit:ne,children:Object(g.jsx)("input",{"data-cy":"NewTodoField",type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",value:l,onChange:function(e){return d(e.target.value)}})})]}),Object(g.jsx)(C,{todos:re,removeTodo:oe,selectedTodoId:y,isLoading:S,title:l,isRemoveLoading:I,updateTodoById:ce,isUpdateLoading:P,isAllToggled:Z}),n.length>0&&Object(g.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(g.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(n.filter((function(e){return!e.completed})).length," items left")}),Object(g.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(g.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:"filter__link ".concat("all"===G?"selected":""),onClick:function(){return K("all")},children:"All"}),Object(g.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:"filter__link ".concat("active"===G?"selected":""),onClick:function(){return K("active")},children:"Active"}),Object(g.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:"filter__link ".concat("completed"===G?"selected":""),onClick:function(){return K("completed")},children:"Completed"})]}),Object(g.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:"todoapp__clear-completed",onClick:function(){return se()},style:n.some((function(e){return e.completed}))?{opacity:1}:{opacity:0},children:"Clear completed"})]})]}),U&&Object(g.jsxs)("div",{"data-cy":"ErrorNotification",className:"notification is-danger is-light has-text-weight-normal",children:[Object(g.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){return D("")}}),U]})]})}),L=function(){return Object(g.jsx)(k,{children:Object(g.jsx)(w,{})})};Object(o.createRoot)(document.getElementById("root")).render(Object(g.jsx)(L,{}))}},[[24,1,2]]]);
//# sourceMappingURL=main.cc2ecda7.chunk.js.map